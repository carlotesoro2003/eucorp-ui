import{s as M}from"../chunks/supabaseClient.CaMOPPuz.js";import{a as v,n as U,c as he,t as H}from"../chunks/disclose-version.CM6f1PTD.js";import{H as ra,X as ia,t as b,p as la,d as w,l as na,e as oa,f as X,a as ca,b as h,g as t,c as e,s,n as Y,r as a}from"../chunks/runtime.g0my00JR.js";import{s as Ve}from"../chunks/render.pmuW5QOO.js";import{i as L}from"../chunks/if.DVEvk735.js";import{b as N,s as va}from"../chunks/attributes.BVavg5V5.js";import{t as c}from"../chunks/class.tYA33czU.js";import{e as Oe}from"../chunks/utils.sCj8HAia.js";import{i as da}from"../chunks/lifecycle.6aQbxLMK.js";import{r as T,p as ma}from"../chunks/props.BjMJLEAs.js";import{s as fa,a as ua}from"../chunks/store.6LPOOnpP.js";/* empty css                         */import{g as A}from"../chunks/entry.CFewmVp1.js";import{o as pa}from"../chunks/index-client.v1G0sw0w.js";import{p as ga}from"../chunks/stores.C8ewMCja.js";import{L as _a}from"../chunks/Login.D30KFOSh.js";function ha(n,i,d,r,l){var S;ra&&ia();var j=(S=i.$$slots)==null?void 0:S[d],x=!1;j===!0&&(j=i.children,x=!0),j===void 0||j(n,x?()=>r:r)}const ba=async()=>{const{data:{session:n}}=await M.auth.getSession(),{data:{user:i}}=await M.auth.getUser();return{supabase:M,user:i,session:n}},Za=Object.freeze(Object.defineProperty({__proto__:null,load:ba},Symbol.toStringTag,{value:"Module"}));var xa=U('<svg><path fill="currentColor" d="M10 20v-6h4v6h5v-8h3L12 3L2 12h3v8z"></path></svg>');function ya(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=xa();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var wa=U('<svg><path fill="currentColor" d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9A3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42c-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3a3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3a3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9c-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65c2.56.34 4.45 1.51 4.45 2.9z"></path></svg>');function $a(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=wa();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var Ma=U('<svg><path fill="currentColor" d="M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M7 8h2v4H8V9H7zm3 9v1H7v-.92L9 15H7v-1h2.25c.41 0 .75.34.75.75c0 .2-.08.39-.21.52L8.12 17zm1-13c0-.55.45-1 1-1s1 .45 1 1s-.45 1-1 1s-1-.45-1-1m6 13h-5v-2h5zm0-6h-5V9h5z"></path></svg>');function De(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=Ma();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var za=U('<svg><path fill="currentColor" d="m16 11.78l4.24-7.33l1.73 1l-5.23 9.05l-6.51-3.75L5.46 19H22v2H2V3h2v14.54L9.5 8z"></path></svg>');function Ye(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=za();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var ka=U('<svg><path fill="currentColor" d="M12 7a5 5 0 0 1 5 5a5 5 0 0 1-5 5a5 5 0 0 1-5-5a5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0-7l2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10l1.76-3.77a7.13 7.13 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10l-4.14.36c.59-.51 1.12-1.14 1.54-1.86c.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44c.82 0 1.63-.17 2.37-.44z"></path></svg>');function Ca(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=ka();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var Pa=U('<svg><path fill="currentColor" d="m17.75 4.09l-2.53 1.94l.91 3.06l-2.63-1.81l-2.63 1.81l.91-3.06l-2.53-1.94L12.44 4l1.06-3l1.06 3zm3.5 6.91l-1.64 1.25l.59 1.98l-1.7-1.17l-1.7 1.17l.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85c-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14c.4-.4.82-.76 1.27-1.08c.75-.53 1.93.36 1.85 1.19c-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82c-2.81 3.14-2.7 7.96.31 10.98c3.02 3.01 7.84 3.12 10.98.31"></path></svg>');function La(n,i){const d=T(i,["$$slots","$$events","$$legacy"]);var r=Pa();let l;b(()=>l=N(r,l,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...d},void 0,!0)),v(n,r)}var Aa=H('<div class="flex items-center justify-center min-h-screen bg-base-300"><span class="loading loading-spinner loading-lg"></span></div>'),Ha=H('<li><details open><summary class="flex items-center gap-3 font-bold"><!> User Management</summary> <ul class="menu ml-4 space-y-2"><li><a href="/users" class="flex items-center gap-3 font-bold">Users</a></li> <li><a href="/departments" class="flex items-center gap-3 font-bold">Departments</a></li> <li><a href="/leads" class="flex items-center gap-3 font-bold">Leads</a></li> <li><a href="/riskManagement" class="flex items-center gap-3 font-bold">Risk Management</a></li> <li><a href="/classification" class="flex items-center gap-3 font-bold">Classification</a></li></ul></details></li> <li><details><summary class="flex items-center gap-3 font-bold"><!> Planning</summary> <ul class="menu ml-4 space-y-2"><li><a href="/plans" class="flex items-center gap-3 font-bold">Strategic Planning</a></li> <li><a href="/risks" class="flex items-center gap-3 font-bold">Risks</a></li> <li><a href="/opportunities" class="flex items-center gap-3 font-bold">Opportunities</a></li></ul></details></li> <li><details><summary class="flex items-center gap-3 font-bold"><!> Monitoring</summary> <ul class="menu ml-4 space-y-2"><li><a href="/monitoring/mid-year" class="flex items-center gap-3 font-bold">Mid-Year Monitoring</a></li> <li><a href="/monitoring" class="flex items-center gap-3 font-bold">Year-End Monitoring</a></li></ul></details></li>',1),ja=H('<li><details><summary class="flex items-center gap-3 font-bold"><!> Planning</summary> <ul class="menu ml-4 space-y-2"><li><a href="/plans/operationalPlans" class="flex items-center gap-3 font-bold">Operational Planning</a></li> <li><a href="/risks" class="flex items-center gap-3 font-bold">Risks Register</a></li> <li><a href="/opportunities" class="flex items-center gap-3 font-bold">Opportunities Register</a></li></ul></details></li> <li><details><summary class="flex items-center gap-3 font-bold"><!> Monitoring</summary> <ul class="menu ml-4 space-y-2"><li><a href="/monitoring/mid-year" class="flex items-center gap-3 font-bold">Mid-Year Monitoring</a></li> <li><a href="/monitoring" class="flex items-center gap-3 font-bold">Year-End Monitoring</a></li></ul></details></li>',1),Sa=H('<img alt="Profile" class="w-10 h-10 rounded-full">'),Ba=H('<div class="w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 18.364A7.986 7.986 7.986 0 0112 14a7.986 7.986 7.986 0 016.879 4.364M12 10a4 4 0 110-8 4 4 0 010 8z"></path></svg></div>'),Ea=H('<div class="flex h-screen bg-base-100 overflow-hidden"><aside class="w-64 bg-base-200 h-screen fixed shadow-lg z-50"><div class="h-16 flex items-center justify-between bg-primary px-4"><span class="font-bold text-lg">EuCorp</span></div> <nav class="flex-1 py-4 px-2"><ul class="menu space-y-2"><li><a href="/dashboard" class="flex items-center gap-3 font-bold"><!> Dashboard</a></li> <!> <!></ul></nav></aside> <div class="flex flex-col flex-1 ml-64 overflow-auto"><header class="h-16 flex justify-between bg-base-300 items-center px-4 fixed top-0 left-64 right-0 z-40 shadow"><div class="flex items-center"><span class="font-bold text-lg"> </span></div> <div class="flex items-center space-x-4"><button class="btn btn-circle btn-sm bg-transparent border-none"><!></button> <div class="dropdown dropdown-end"><button class="btn btn-ghost"><!></button> <ul class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"><li><span class="text-gray-500 text-xs"> </span></li> <li><a href="/profile">Profile</a></li> <li><button class="w-full text-left">Logout</button></li></ul></div></div></header> <main class="pt-20 px-4 bg-base-100 h-full"><!></main></div></div>'),Ra=H('<div class="flex items-center justify-center min-h-screen bg-base-300"><div class="text-center"><h1 class="text-2xl font-bold text-yellow-500 mb-4">Pending for System Access</h1> <p class="text-white">Your account is under review. Please wait for verification.</p></div></div>');function et(n,i){la(i,!1);const d=fa(),r=()=>ua(ga,"$page",d);let j=ma(i,"data",8)(),x=w(j.session),S=w(!0),ae=w(!1),F=w(null),be=w(""),te=w(null),xe=w(null),o=w(""),I=w(!0);const ye=async()=>{var m,$;if(!t(x)){h(S,!1),A("/login");return}try{const g=t(x).user,{data:f,error:y}=await M.from("profiles").select("id, role, is_verified, profile_pic, department_id, email").eq("id",g.id).single();if(y)if(y.code==="PGRST116"){const{error:u}=await M.from("profiles").insert({id:g.id,email:g.email,first_name:((m=g.user_metadata)==null?void 0:m.first_name)||"New",last_name:(($=g.user_metadata)==null?void 0:$.last_name)||"User",role:"user",is_verified:!1});if(u){A("/login");return}}else{A("/login");return}if(f){if(h(ae,f.is_verified??!1),h(F,f.role??null),h(te,f.profile_pic),h(xe,f.email),f.department_id){const{data:u}=await M.from("departments").select("name").eq("id",f.department_id).single();h(be,(u==null?void 0:u.name)??"No Department")}if(!t(ae)){A("/login");return}}}catch{A("/login")}finally{h(S,!1)}};async function Ue(){const{error:m}=await M.auth.signOut();m&&console.error("Error logging out:",m.message),A("/login")}function Ne(){h(I,!t(I)),document.documentElement.setAttribute("data-theme",t(I)?"dark":"light")}pa(()=>{ye();const{data:m}=M.auth.onAuthStateChange(($,g)=>{h(x,g),t(x)?ye():A("/login")});return()=>{m.subscription.unsubscribe()}}),na(()=>r(),()=>{h(o,r().url.pathname)}),oa(),da();var we=he(),Te=X(we);L(Te,()=>t(S),m=>{var $=Aa();v(m,$)},m=>{var $=he(),g=X($);L(g,()=>t(x)&&t(ae),f=>{var y=Ea(),u=e(y),B=s(e(u),2),J=e(B),se=e(J),re=e(se),qe=e(re);ya(qe,{class:"h-6 w-6 text-secondary"}),Y(),a(re),a(se);var $e=s(se,2);L($e,()=>t(F)==="admin",p=>{var _=Ha(),z=X(_),q=e(z),k=e(q),ce=e(k);$a(ce,{class:"h-6 w-6 text-accent"}),Y(),a(k);var W=s(k,2),C=e(W),ve=e(C);a(C);var P=s(C,2),de=e(P);a(P);var E=s(P,2),me=e(E);a(E);var R=s(E,2),Q=e(R);a(R);var V=s(R,2),fe=e(V);a(V),a(W),a(q),a(z);var O=s(z,2),D=e(O),G=e(D),Z=e(G);De(Z,{class:"h-6 w-6"}),Y(),a(G);var ee=s(G,2),ue=e(ee),Qe=e(ue);a(ue);var pe=s(ue,2),Ze=e(pe);a(pe);var je=s(pe,2),ea=e(je);a(je),a(ee),a(D),a(O);var Se=s(O,2),Be=e(Se),ge=e(Be),aa=e(ge);Ye(aa,{class:"h-6 w-6 "}),Y(),a(ge);var Ee=s(ge,2),_e=e(Ee),ta=e(_e);a(_e);var Re=s(_e,2),sa=e(Re);a(Re),a(Ee),a(Be),a(Se),b(()=>{c(ve,"active",t(o)==="/users"),c(de,"active",t(o)==="/departments"),c(me,"active",t(o)==="/leads"),c(Q,"active",t(o)==="/riskmanagement"),c(fe,"active",t(o)==="/classification"),c(Qe,"active",t(o)==="/plans"),c(Ze,"active",t(o)==="/risks"),c(ea,"active",t(o)==="/opportunities"),c(ta,"active",t(o)==="/monitoring/mid-year"),c(sa,"active",t(o)==="/monitoring")}),v(p,_)});var We=s($e,2);L(We,()=>t(F)!=="admin",p=>{var _=ja(),z=X(_),q=e(z),k=e(q),ce=e(k);De(ce,{class:"h-6 w-6 text-purple-400"}),Y(),a(k);var W=s(k,2),C=e(W),ve=e(C);a(C);var P=s(C,2),de=e(P);a(P);var E=s(P,2),me=e(E);a(E),a(W),a(q),a(z);var R=s(z,2),Q=e(R),V=e(Q),fe=e(V);Ye(fe,{class:"h-6 w-6 "}),Y(),a(V);var O=s(V,2),D=e(O),G=e(D);a(D);var Z=s(D,2),ee=e(Z);a(Z),a(O),a(Q),a(R),b(()=>{c(ve,"active",t(o)==="/plans/operationalPlans"),c(de,"active",t(o)==="/risks"),c(me,"active",t(o)==="/opportunities"),c(G,"active",t(o)==="/monitoring/mid-year"),c(ee,"active",t(o)==="/monitoring")}),v(p,_)}),a(J),a(B),a(u);var Me=s(u,2),ie=e(Me),le=e(ie),ze=e(le),Ge=e(ze);a(ze),a(le);var ke=s(le,2),K=e(ke),Xe=e(K);L(Xe,()=>t(I),p=>{La(p,{class:"h-6 w-6"})},p=>{Ca(p,{class:"h-6 w-6"})}),a(K);var Ce=s(K,2),ne=e(Ce),Fe=e(ne);L(Fe,()=>t(te),p=>{var _=Sa();b(()=>va(_,"src",t(te))),v(p,_)},p=>{var _=Ba();v(p,_)}),a(ne);var Pe=s(ne,2),oe=e(Pe),Le=e(oe),Ie=e(Le,!0);a(Le),a(oe);var Ae=s(oe,4),Je=e(Ae);a(Ae),a(Pe),a(Ce),a(ke),a(ie);var He=s(ie,2),Ke=e(He);ha(Ke,i,"default",{}),a(He),a(Me),a(y),b(()=>{c(re,"active",t(o)==="/dashboard"),Ve(Ge,`${(t(F)==="admin"?"Admin Panel":t(be))??""} Dashboard`),Ve(Ie,t(xe))}),Oe("click",K,Ne),Oe("click",Je,Ue),v(f,y)},f=>{var y=he(),u=X(y);L(u,()=>!t(x),B=>{_a(B,{})},B=>{var J=Ra();v(B,J)},!0),v(f,y)},!0),v(m,$)}),v(n,we),ca()}export{et as component,Za as universal};
