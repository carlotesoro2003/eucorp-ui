import{c as I,a as p,t as g,b as ct}from"../chunks/disclose-version.CM6f1PTD.js";import{p as dt,f as U,g as e,a as pt,b as f,s as u,c,r as i,t as B,d as T,i as kt}from"../chunks/runtime.g0my00JR.js";import{e as O}from"../chunks/utils.sCj8HAia.js";import{i as y}from"../chunks/if.DVEvk735.js";import{s as bt}from"../chunks/class.tYA33czU.js";import{i as vt}from"../chunks/lifecycle.6aQbxLMK.js";import{p as St}from"../chunks/props.BjMJLEAs.js";import{s as at}from"../chunks/supabaseClient.CaMOPPuz.js";import{s as S}from"../chunks/render.pmuW5QOO.js";import{e as ut,i as mt}from"../chunks/each.BeKM084r.js";import{o as _t}from"../chunks/index-client.v1G0sw0w.js";import{E as xt,a as Et}from"../chunks/jspdf.plugin.autotable.4s0l0uhg.js";import{a as yt}from"../chunks/attributes.BVavg5V5.js";import{r as wt}from"../chunks/misc.CY9ixZp3.js";import{a as Pt}from"../chunks/axios.CCb-kr4I.js";import{s as Ot,a as Nt}from"../chunks/store.6LPOOnpP.js";/* empty css                         */import{w as Mt,g as Rt}from"../chunks/index.C34d6m6q.js";var Dt=g('<div class="text-center text-xl"><span class="loading loading-spinner loading-md"></span> Loading...</div>'),Lt=g('<tr class="hover border-b"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td></tr>'),zt=g('<div class="overflow-x-auto shadow-lg rounded-lg"><table class="table-auto w-full text-left text-sm border-collapse"><thead class="uppercase text-xs"><tr><th class="px-4 py-3">Actions Taken</th><th class="px-4 py-3">KPI</th><th class="px-4 py-3">Evaluation</th><th class="px-4 py-3">Statement</th><th class="px-4 py-3">Status</th><th class="px-4 py-3">Time Completed</th></tr></thead><tbody></tbody></table></div>'),Tt=g("<div>No plans found for this filter.</div>"),jt=g('<div class="min-h-screen p-8 bg-base-300"><h1 class="text-3xl font-bold mb-6">Plans Monitoring</h1> <div class="flex space-x-4 mb-4"><button class="btn btn-primary svelte-1tziaei">Show All</button> <button class="btn btn-success svelte-1tziaei">Show Achieved</button> <button class="btn btn-error svelte-1tziaei">Show Not Achieved</button> <button class="btn btn-secondary ml-auto svelte-1tziaei">Export to PDF</button></div> <!></div>');function Ct(q,j){dt(j,!1);let b=[],A=T([]),k=T("all"),M=T(!0);const x=async()=>{f(M,!0);try{const{data:h,error:a}=await at.from("plan_monitoring").select(`
            id,
            action_plan_id,
            evaluation,
            statement,
            is_accomplished,
            time_completed,
            action_plans (actions_taken, kpi)
          `);if(a){console.error("Error fetching plan monitoring:",a);return}b=h.map(s=>{var l,r;return{id:s.id,action_plan_id:s.action_plan_id,evaluation:s.evaluation,statement:s.statement,is_accomplished:s.is_accomplished,time_completed:s.time_completed,actions_taken:((l=s.action_plans)==null?void 0:l.actions_taken)||"No Actions Taken",kpi:((r=s.action_plans)==null?void 0:r.kpi)||"No KPI"}}),C()}catch(h){console.error("Error fetching data:",h)}finally{f(M,!1)}},C=()=>{e(k)==="all"?f(A,b):e(k)==="achieved"?f(A,b.filter(h=>h.is_accomplished)):e(k)==="not_achieved"&&f(A,b.filter(h=>!h.is_accomplished))},F=()=>{const h=new xt("landscape"),a="Plan Monitoring Report";h.setFontSize(12),h.text(a,14,15);const s=["Actions Taken","KPI","Evaluation","Statement","Status","Time Completed"],l=e(A).map(r=>[r.actions_taken,r.kpi,r.evaluation,r.statement,r.is_accomplished?"Achieved":"Not Achieved",r.time_completed?new Date(r.time_completed).toLocaleString():"N/A"]);Et(h,{head:[s],body:l,startY:25,theme:"grid",styles:{fontSize:10},headStyles:{fillColor:[41,128,185]}}),h.save("PlanMonitoring.pdf")};_t(async()=>{await x()}),vt();var G=jt(),z=u(c(G),2),K=c(z),Y=u(K,2),H=u(Y,2),J=u(H,2);i(z);var R=u(z,2);y(R,()=>e(M),h=>{var a=Dt();p(h,a)},h=>{var a=I(),s=U(a);y(s,()=>e(A).length>0,l=>{var r=zt(),_=c(r),v=u(c(_));ut(v,5,()=>e(A),mt,(n,o)=>{var t=Lt(),d=c(t),m=c(d,!0);i(d);var w=u(d),E=c(w,!0);i(w);var P=u(w),L=c(P,!0);i(P);var N=u(P),D=c(N,!0);i(N);var Q=u(N),X=c(Q,!0);i(Q);var $=u(Q),Z=c($,!0);B(()=>S(Z,e(o).time_completed?new Date(e(o).time_completed).toLocaleString():"N/A")),i($),i(t),B(()=>{S(m,e(o).actions_taken),S(E,e(o).kpi),S(L,e(o).evaluation||"Pending Evaluation"),S(D,e(o).statement||"Pending Statement"),S(X,e(o).is_accomplished?"Achieved":"Not Achieved")}),p(n,t)}),i(v),i(_),i(r),p(l,r)},l=>{var r=Tt();p(l,r)},!0),p(h,a)}),i(G),O("click",K,()=>{f(k,"all"),C()}),O("click",Y,()=>{f(k,"achieved"),C()}),O("click",H,()=>{f(k,"not_achieved"),C()}),O("click",J,F),p(q,G),pt()}var Ft=g("<h1>Risks Monitoring</h1>");function Kt(q){var j=Ft();p(q,j)}var It=g('<div class="text-center"><span class="loading loading-spinner text-primary"></span> <p>Loading opportunities...</p></div>'),Ut=g('<tr class="hover"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td></tr>'),qt=g('<div class="overflow-x-auto shadow-lg rounded-lg"><table class="table-auto w-full text-left text-sm"><thead><tr><th class="px-4 py-3">Opportunity Statement</th><th class="px-4 py-3">KPI</th><th class="px-4 py-3">Planned Actions</th><th class="px-4 py-3">Evaluation</th><th class="px-4 py-3">Status</th><th class="px-4 py-3">Achieved On</th></tr></thead><tbody></tbody></table></div>'),Gt=g('<div class="min-h-screen p-8"><h1 class="text-3xl font-bold mb-6">Opportunities Monitoring (Admin)</h1> <div class="flex space-x-4 mb-4"><button class="btn btn-primary svelte-1ll86zc">Show All</button> <button class="btn btn-success svelte-1ll86zc">Show Achieved</button> <button class="btn btn-error svelte-1ll86zc">Show Not Achieved</button> <button class="btn btn-secondary ml-auto svelte-1ll86zc">Export to PDF</button></div> <!></div>');function Yt(q,j){dt(j,!1);let b=[],A=T([]),k="All",M=T(!0);const x=async()=>{f(M,!0);const{data:a,error:s}=await at.from("opt_monitoring").select(`
                opt_id,
                opportunities(opt_statement, kpi, planned_actions),
                evaluation,
                is_accomplished,
                time_completed
            `);if(s){console.error("Error fetching opportunities:",s);return}a&&(b=a.map(l=>({opt_id:l.opt_id,opt_statement:l.opportunities.opt_statement,kpi:l.opportunities.kpi,planned_actions:l.opportunities.planned_actions,evaluation:l.evaluation,achieved:l.is_accomplished,time_completed:l.time_completed})),C()),f(M,!1)},C=()=>{k==="Achieved"?f(A,b.filter(a=>a.achieved)):k==="Not Achieved"?f(A,b.filter(a=>!a.achieved)):f(A,b)},F=a=>{k=a,C()},G=()=>{const a=new xt("landscape"),s="Opportunities Monitoring Report";a.setFontSize(12),a.text(s,14,15);const l=["Opportunity Statement","KPI","Planned Actions","Evaluation","Status","Achieved On"],r=e(A).map(o=>[o.opt_statement,o.kpi,o.planned_actions,o.evaluation||"Pending",o.achieved?"Achieved":"Not Achieved",o.achieved&&o.time_completed?new Date(o.time_completed).toLocaleDateString():"N/A"]);let _=25;const v=10,n=[60,40,60,40,30,30];a.setFontSize(10),l.forEach((o,t)=>{a.rect(14+n.slice(0,t).reduce((d,m)=>d+m,0),_,n[t],v),a.text(o,14+n.slice(0,t).reduce((d,m)=>d+m,0)+2,_+7)}),_+=v,r.forEach(o=>{o.forEach((t,d)=>{a.rect(14+n.slice(0,d).reduce((m,w)=>m+w,0),_,n[d],8),a.text(t,14+n.slice(0,d).reduce((m,w)=>m+w,0)+2,_+5)}),_+=8}),a.save("OpportunitiesMonitoring.pdf")};_t(()=>{x()}),vt();var z=Gt(),K=u(c(z),2),Y=c(K),H=u(Y,2),J=u(H,2),R=u(J,2);i(K);var h=u(K,2);y(h,()=>e(M),a=>{var s=It();p(a,s)},a=>{var s=qt(),l=c(s),r=u(c(l));ut(r,5,()=>e(A),mt,(_,v)=>{let n=()=>e(v).opt_statement,o=()=>e(v).kpi,t=()=>e(v).planned_actions,d=()=>e(v).evaluation,m=()=>e(v).achieved,w=()=>e(v).time_completed;var E=Ut(),P=c(E),L=c(P,!0);i(P);var N=u(P),D=c(N,!0);i(N);var Q=u(N),X=c(Q,!0);i(Q);var $=u(Q),Z=c($,!0);i($);var ot=u($),it=c(ot,!0);i(ot);var rt=u(ot),lt=c(rt,!0);B(()=>S(lt,m()&&w()?new Date(w()).toLocaleDateString():"N/A")),i(rt),i(E),B(()=>{S(L,n()),S(D,o()),S(X,t()),S(Z,d()||"Pending"),S(it,m()?"Achieved":"Not Achieved")}),p(_,E)}),i(r),i(l),i(s),p(a,s)}),i(z),O("click",Y,()=>F("All")),O("click",H,()=>F("Achieved")),O("click",J,()=>F("Not Achieved")),O("click",R,G),p(q,z),pt()}var $t=g('<div class="text-center text-xl"><span class="loading loading-spinner loading-md"></span></div>'),Ht=g('<button class="btn btn-primary btn-sm ml-2">View Statement</button>'),Jt=g('<tr class="hover border-b"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"><textarea class="border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring focus:ring-indigo-200" placeholder="Enter actions taken..." style="overflow:hidden; resize:none;"></textarea></td><td class="px-4 py-3"><!></td><td class="px-4 py-3"><button class="btn btn-success btn-sm">Evaluate</button> <!></td></tr>'),Vt=g('<div class="overflow-x-auto shadow-lg rounded-lg"><table class="table-auto w-full text-left text-sm border-collapse"><thead class="uppercase text-xs"><tr><th class="px-4 py-3">Strategic Goal</th><th class="px-4 py-3">Objective Name</th><th class="px-4 py-3">Strategic Initiatives</th><th class="px-4 py-3">KPI</th><th class="px-4 py-3">Actions Taken to Achieve Action Plan</th><th class="px-4 py-3">Status</th><th class="px-4 py-3">Actions</th></tr></thead><tbody></tbody></table></div>'),Wt=g("<div>No action plans found for this user.</div>"),Bt=g('<div class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50"><div class="bg-white p-6 rounded-lg shadow-lg w-96"><h2 class="text-lg font-bold mb-4">Evaluation Statement</h2> <p class="mb-4"> </p> <button class="btn bg-indigo-500 hover:bg-indigo-600 text-white w-full">Close</button></div></div>'),Qt=g('<div class="min-h-screen p-8 bg-base-300"><h1 class="text-3xl font-bold mb-6">Plans Monitoring</h1> <!> <!></div>');function Xt(q,j){dt(j,!1);let b=T([]),A=null,k=T(!0),M=T(!1),x=T("");const C="http://localhost:3000/evaluate-goal",F=async()=>{const{data:{user:a}}=await at.auth.getUser();a?A=a.id:console.error("No logged-in user found.")},G=async()=>{if(A)try{const{data:a,error:s}=await at.from("action_plans").select(`
          id,
          actions_taken,
          kpi,
          objective_id,
          strategic_objectives (
            name,
            strategic_goals (name)
          )
        `).eq("profile_id",A);if(s){console.error("Error fetching action plans:",s);return}f(b,a.map(l=>{var r,_,v;return{id:l.id,actions_taken:l.actions_taken,kpi:l.kpi,objective_id:l.objective_id,strategic_goal_name:((_=(r=l.strategic_objectives)==null?void 0:r.strategic_goals)==null?void 0:_.name)||"No Goal Assigned",objective_name:((v=l.strategic_objectives)==null?void 0:v.name)||"No Objective Assigned",is_accomplished:!1,evaluation:null,statement:null,time_completed:null}})),await z()}catch(a){console.error("Error fetching data:",a)}finally{f(k,!1)}},z=async()=>{try{const{data:a,error:s}=await at.from("plan_monitoring").select("action_plan_id, is_accomplished, evaluation, statement, time_completed").in("action_plan_id",e(b).map(l=>l.id));if(s){console.error("Error fetching monitoring data:",s);return}f(b,e(b).map(l=>{const r=a.find(_=>_.action_plan_id===l.id);return{...l,is_accomplished:(r==null?void 0:r.is_accomplished)||!1,evaluation:(r==null?void 0:r.evaluation)||null,statement:(r==null?void 0:r.statement)||null,time_completed:(r==null?void 0:r.time_completed)||null}})),console.log("Updated Action Plans with Monitoring Data:",e(b))}catch(a){console.error("Error fetching plan monitoring data:",a)}},K=async(a,s,l)=>{try{const _=(await Pt.post(C,{target:s,evaluation:l})).data.aiEvaluation,n=!["not achieved","unsuccessful","failed","incomplete","fell short","below target","did not meet","not"].some(d=>_.toLowerCase().includes(d)),o=n?new Date().toISOString():null,{error:t}=await at.from("plan_monitoring").update({evaluation:l,is_accomplished:n,statement:_,time_completed:o}).eq("action_plan_id",a);if(t){console.error("Error updating plan monitoring:",t);return}f(b,e(b).map(d=>d.id===a?{...d,is_accomplished:n,evaluation:l,statement:_,time_completed:o}:d))}catch(r){console.error("Error evaluating action plan:",r)}},Y=a=>{f(x,a),f(M,!0)},H=a=>{const s=a.target;s.style.height="auto",s.style.height=`${s.scrollHeight}px`};_t(async()=>{await F(),await G()}),vt();var J=Qt(),R=u(c(J),2);y(R,()=>e(k),a=>{var s=$t();p(a,s)},a=>{var s=I(),l=U(s);y(l,()=>e(b).length>0,r=>{var _=Vt(),v=c(_),n=u(c(v));ut(n,5,()=>e(b),mt,(o,t)=>{var d=Jt(),m=c(d),w=c(m,!0);i(m);var E=u(m),P=c(E,!0);i(E);var L=u(E),N=c(L,!0);i(L);var D=u(L),Q=c(D,!0);i(D);var X=u(D),$=c(X);wt($),i(X);var Z=u(X),ot=c(Z);y(ot,()=>e(t).is_accomplished,tt=>{var st=ct();B(()=>S(st,`Achieved on ${(e(t).time_completed?new Date(e(t).time_completed).toLocaleString():"N/A")??""}`)),p(tt,st)},tt=>{var st=ct("Not Achieved");p(tt,st)}),i(Z);var it=u(Z),rt=c(it),lt=u(rt,2);y(lt,()=>e(t).statement,tt=>{var st=Ht();O("click",st,()=>Y(e(t).statement||"")),p(tt,st)}),i(it),i(d),B(()=>{S(w,e(t).strategic_goal_name),S(P,e(t).objective_name),S(N,e(t).actions_taken),S(Q,e(t).kpi),yt($,e(t).evaluation),$.disabled=e(t).is_accomplished,rt.disabled=!e(t).evaluation||e(t).is_accomplished}),O("input",$,tt=>{e(t).evaluation=tt.target.value,kt(()=>e(b)),H(tt)}),O("click",rt,()=>K(e(t).id,e(t).kpi,e(t).evaluation||"")),p(o,d)}),i(n),i(v),i(_),p(r,_)},r=>{var _=Wt();p(r,_)},!0),p(a,s)});var h=u(R,2);y(h,()=>e(M),a=>{var s=Bt(),l=c(s),r=u(c(l),2),_=c(r,!0);i(r);var v=u(r,2);i(l),i(s),B(()=>S(_,e(x))),O("click",v,()=>f(M,!1)),p(a,s)}),i(J),p(q,J),pt()}var Zt=g("<h1>Risks  Monitoring</h1>");function te(q){var j=Zt();p(q,j)}var ee=g('<span class="loading loading-spinner text-primary"></span>'),ae=g('<span class="loading loading-spinner text-primary"></span>'),oe=g('<button class="btn btn-success btn-sm" disabled>Achieved</button>'),se=g('<button class="btn btn-success btn-sm">Evaluate</button>'),ie=g('<button class="btn btn-primary btn-sm ml-2">View Statement</button>'),re=g('<tr class="hover border-b"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"><textarea class="border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring focus:ring-indigo-200" placeholder="Enter your evaluation" style="overflow:hidden; resize:none; min-width: 200px;"></textarea></td><td class="px-4 py-3"><!></td><td class="px-4 py-3"><!> <!></td></tr>'),ne=g('<div class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50"><div class="bg-white p-6 rounded-lg shadow-lg w-96"><h2 class="text-lg font-bold mb-4">AI Evaluation Statement</h2> <p class="mb-4"> </p> <button class="btn bg-indigo-500 hover:bg-indigo-600 text-white w-full">Close</button></div></div>'),le=g('<div class="min-h-screen p-8"><h1 class="text-3xl font-bold mb-6">Mid-Year Opportunity Monitoring</h1> <button class="btn bg-indigo-500 hover:bg-indigo-600 text-white font-medium mb-6">Evaluate All Opportunities</button> <div class="overflow-x-auto shadow-lg rounded-lg"><table class="table-auto w-full text-left text-sm border-collapse"><thead class="uppercase text-xs"><tr><th class="px-4 py-3">Opportunity Statement</th><th class="px-4 py-3">Target (KPI)</th><th class="px-4 py-3">Evaluation</th><th class="px-4 py-3">Achieved</th><th class="px-4 py-3">Actions</th></tr></thead><tbody></tbody></table></div> <!></div>');function ce(q,j){dt(j,!1);const b=Ot(),A=()=>Nt(x,"$goals",b);let k=[],M=null,x=Mt([]),C=T(!1),F=T("");function G(v){f(F,v),f(C,!0)}const z=async()=>{const{data:{session:v},error:n}=await at.auth.getSession();if(n||!v){console.error("Error fetching session:",n);return}const{user:o}=v,{data:t,error:d}=await at.from("profiles").select("id").eq("id",o.id).single();if(d||!t){console.error("Error fetching profile:",d);return}M=t.id},K=async()=>{if(!M)return;const{data:v,error:n}=await at.from("opt_monitoring").select("opt_id, time_completed, evaluation, statement, opportunities (opt_statement, kpi, planned_actions)").eq("profile_id",M);if(n)console.error(n);else{k=v.map(t=>({opt_id:t.opt_id,opt_statement:t.opportunities.opt_statement,kpi:t.opportunities.kpi,planned_actions:t.opportunities.planned_actions,time_completed:t.time_completed,evaluation:t.evaluation||"",statement:t.statement||null}));const o=k.map(t=>({id:t.opt_id,statement:t.opt_statement,goal:t.kpi,evaluation:t.evaluation||"",achieved:t.time_completed?"Achieved":null,isLoading:!1,timeCompleted:t.time_completed,aiStatement:t.statement||null}));x.set(o)}};async function Y(v,n,o){x.update(t=>t.map(d=>d.id===v?{...d,isLoading:!0}:d));try{const t=await fetch("/api/evaluate-goal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({target:n,evaluation:o})}),d=await t.json();if(!t.ok||d.error)throw new Error(d.error||"Failed to evaluate goal.");const m=d.aiEvaluation;if(console.log("[DEBUG] AI Evaluation:",m),typeof m!="string")throw new TypeError("AI evaluation response is not a valid string.");const E=!["not achieved","unsuccessful","failed","incomplete","fell short","below target","did not meet","not","not been achieved"].some(N=>m.toLowerCase().includes(N)),P=E?new Date().toISOString():null,{error:L}=await at.from("opt_monitoring").update({time_completed:P,evaluation:o,statement:m,is_accomplished:E}).eq("opt_id",v);L?console.error("[ERROR] Error updating opt_monitoring:",L):x.update(N=>N.map(D=>D.id===v?{...D,achieved:E?"Achieved":"Not Achieved",isLoading:!1,timeCompleted:P,aiStatement:m}:D))}catch(t){console.error("[ERROR] Error evaluating goal:",t),x.update(d=>d.map(m=>m.id===v?{...m,isLoading:!1}:m))}}async function H(){const n=Rt(x).map(o=>({opt_statement:o.statement,kpi:o.goal,achieved:o.achieved==="Achieved",evaluation:o.evaluation}));try{const o=await fetch("/api/generate-summary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({monitoringData:n})}),t=await o.json();if(!o.ok||t.error)throw new Error(t.error||"Failed to generate summary.");console.log("Summary Report:",t.summaryReport)}catch(o){console.error("Error generating summary:",o)}}function J(v,n,o){x.update(t=>t.map(d=>d.id===v?{...d,[n]:o}:d))}function R(v){const n=v.target;n.style.height="auto",n.style.width="auto",n.style.height=`${n.scrollHeight}px`,n.style.width=`${n.scrollWidth+20}px`}_t(async()=>{await z(),await K()}),vt();var h=le(),a=u(c(h),2),s=u(a,2),l=c(s),r=u(c(l));ut(r,5,A,mt,(v,n)=>{let o=()=>e(n).id,t=()=>e(n).statement,d=()=>e(n).goal,m=()=>e(n).evaluation,w=()=>e(n).achieved,E=()=>e(n).isLoading,P=()=>e(n).timeCompleted,L=()=>e(n).aiStatement;var N=re(),D=c(N),Q=c(D,!0);i(D);var X=u(D),$=c(X,!0);i(X);var Z=u(X),ot=c(Z);wt(ot),i(Z);var it=u(Z),rt=c(it);y(rt,E,V=>{var W=ee();p(V,W)},V=>{var W=I(),ht=U(W);y(ht,()=>w()==="Achieved",nt=>{var et=ct();B(()=>S(et,`Achieved on ${(P()?new Date(P()).toLocaleDateString():"N/A")??""}`)),p(nt,et)},nt=>{var et=I(),At=U(et);y(At,()=>w()==="Not Achieved",gt=>{var ft=ct("Not Achieved");p(gt,ft)},gt=>{var ft=ct("Pending");p(gt,ft)},!0),p(nt,et)},!0),p(V,W)}),i(it);var lt=u(it),tt=c(lt);y(tt,E,V=>{var W=ae();p(V,W)},V=>{var W=I(),ht=U(W);y(ht,()=>w()==="Achieved",nt=>{var et=oe();p(nt,et)},nt=>{var et=se();B(()=>et.disabled=!m()||E()),O("click",et,()=>Y(o(),d(),m())),p(nt,et)},!0),p(V,W)});var st=u(tt,2);y(st,L,V=>{var W=ie();O("click",W,()=>G(L())),p(V,W)}),i(lt),i(N),B(()=>{S(Q,t()),S($,d()),yt(ot,m()),ot.disabled=w()==="Achieved"}),O("input",ot,V=>{J(o(),"evaluation",V.target.value),R(V)}),p(v,N)}),i(r),i(l),i(s);var _=u(s,2);y(_,()=>e(C),v=>{var n=ne(),o=c(n),t=u(c(o),2),d=c(t,!0);i(t);var m=u(t,2);i(o),i(n),B(()=>S(d,e(F))),O("click",m,()=>f(C,!1)),p(v,n)}),i(h),O("click",a,H),p(q,h),pt()}var de=g('<div class="text-center"><span class="loading loading-spinner loading-lg"></span> <p class="mt-2">Loading...</p></div>'),pe=g('<p class="text-white text-xl">You do not have the required permissions to view this page.</p>'),ve=g('<p class="text-red-500 text-xl">Failed to load session or profile data.</p>'),ue=g('<div class="min-h-screen bg-base-300 p-8"><div role="tablist" class="tabs tabs-boxed"><a role="tab">Plans</a> <a role="tab">Risks</a> <a role="tab">Opportunities</a></div> <!></div>');function De(q,j){dt(j,!1);let b=St(j,"data",8,null),A=T(null),k=T(null),M=T(!0),x=T("Plans");(async()=>{var R;try{if((R=b())!=null&&R.session){f(A,b().session);const{user:h}=e(A),{data:a,error:s}=await at.from("profiles").select("role").eq("id",h.id).single();s?console.error("Error fetching user profile:",s.message):(f(k,a),console.log("Role in Opportunities: ",e(k)))}else console.warn("Session is not available or data is missing.")}catch(h){console.error("Error fetching user profile or session:",h)}finally{f(M,!1)}})();const F=R=>{f(x,R)};vt();var G=ue(),z=c(G),K=c(z),Y=u(K,2),H=u(Y,2);i(z);var J=u(z,2);y(J,()=>e(M),R=>{var h=de();p(R,h)},R=>{var h=I(),a=U(h);y(a,()=>e(A)!==null&&e(k),s=>{var l=I(),r=U(l);y(r,()=>e(k).role==="admin",_=>{var v=I(),n=U(v);y(n,()=>e(x)==="Plans",o=>{Ct(o,{})},o=>{var t=I(),d=U(t);y(d,()=>e(x)==="Risks",m=>{Kt(m)},m=>{var w=I(),E=U(w);y(E,()=>e(x)==="Opportunities",P=>{Yt(P,{})},null,!0),p(m,w)},!0),p(o,t)}),p(_,v)},_=>{var v=I(),n=U(v);y(n,()=>e(k).role==="user",o=>{var t=I(),d=U(t);y(d,()=>e(x)==="Plans",m=>{Xt(m,{})},m=>{var w=I(),E=U(w);y(E,()=>e(x)==="Risks",P=>{te(P)},P=>{var L=I(),N=U(L);y(N,()=>e(x)==="Opportunities",D=>{ce(D,{})},null,!0),p(P,L)},!0),p(m,w)}),p(o,t)},o=>{var t=pe();p(o,t)},!0),p(_,v)}),p(s,l)},s=>{var l=ve();p(s,l)},!0),p(R,h)}),i(G),B(()=>{bt(K,`tab ${(e(x)==="Plans"?"tab-active":"")??""}`),bt(Y,`tab ${(e(x)==="Risks"?"tab-active":"")??""}`),bt(H,`tab ${(e(x)==="Opportunities"?"tab-active":"")??""}`)}),O("click",K,()=>F("Plans")),O("click",Y,()=>F("Risks")),O("click",H,()=>F("Opportunities")),p(q,G),pt()}export{De as component};
