import{a as w,t as k}from"../chunks/disclose-version.CM6f1PTD.js";import{p as vt,l as _t,e as ut,t as E,a as mt,g as t,c as l,b as v,s as n,r as i,i as p,d as y}from"../chunks/runtime.g0my00JR.js";import{s as W}from"../chunks/render.pmuW5QOO.js";import{i as Y}from"../chunks/if.DVEvk735.js";import{e as Z,i as tt}from"../chunks/each.BeKM084r.js";import{e as _}from"../chunks/utils.sCj8HAia.js";import{r as b}from"../chunks/misc.CY9ixZp3.js";import{b as x}from"../chunks/input.N22HgeA5.js";import{b as pt}from"../chunks/select.BRIlu2rr.js";import{i as ft}from"../chunks/lifecycle.6aQbxLMK.js";import{o as gt}from"../chunks/index-client.v1G0sw0w.js";import{s as S}from"../chunks/supabaseClient.CaMOPPuz.js";var ht=k('<div class="alert alert-success shadow-lg my-4"><div><span> </span></div></div>'),bt=k('<div class="alert alert-error shadow-lg my-4"><div><span> </span></div></div>'),xt=k("<option> </option>"),wt=k('<tr><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter objective name"></textarea></td><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter strategic initiatives"></textarea></td><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter KPI"></textarea></td><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter persons involved"></textarea></td><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter target"></textarea></td><td><textarea class="textarea textarea-bordered w-full resize-none" placeholder="Enter evaluation measures"></textarea></td><td><button class="btn btn-error btn-sm">Delete</button></td></tr>'),yt=k('<div class="min-h-screen bg-base-300 p-8"><h1 class="text-2xl font-bold mb-4 text-white">Create Strategic Objectives</h1> <!> <!> <div class="mb-4"><label for="strategic_goal" class="block text-lg font-bold text-white mb-2">Select Strategic Goal</label> <select id="strategic_goal" class="select select-bordered w-full font-semibold bg-gray-800 text-white" required><option disabled selected>Select a goal</option><!></select></div> <div class="overflow-x-auto"><table class="table w-full table-zebra shadow-lg rounded-lg"><thead><tr><th>Objective Name</th><th>Strategic Initiatives</th><th>KPI</th><th>Persons Involved</th><th>Target</th><th>Evaluation Measures</th><th>Actions</th></tr></thead><tbody></tbody></table></div> <div class="flex space-x-4 mt-4"><button class="btn btn-primary">Add Objective</button> <button class="btn btn-success">Submit Objectives</button></div></div>');function At(et,at){vt(at,!1);let z=null,u=null,P=y([]),f=y(null),o=y([{name:"",strategic_initiatives:"",kpi:"",persons_involved:"",target:"",eval_measures:"",strategic_goal_id:0,profile_id:""}]),g=y(null),m=y(null);const rt=async()=>{try{const{data:a,error:e}=await S.auth.getSession();if(e)throw e;if(z=a.session,z){const{user:r}=z,{data:d,error:c}=await S.from("profiles").select("id").eq("id",r.id).single();if(c)throw c;u=d}}catch(a){v(m,a.message)}finally{}},st=async()=>{try{const{data:a,error:e}=await S.from("strategic_goals").select("id, name");if(e)throw e;v(P,a)}catch{v(m,"Failed to fetch strategic goals.")}},it=()=>{v(o,[...t(o),{name:"",strategic_initiatives:"",kpi:"",persons_involved:"",target:"",eval_measures:"",strategic_goal_id:t(f)||0,profile_id:(u==null?void 0:u.id)||""}])},lt=a=>{t(o).length>1&&v(o,t(o).filter((e,r)=>r!==a))},ot=async()=>{try{if(!t(f))throw new Error("Please select a strategic goal");if(!(u!=null&&u.id))throw new Error("Invalid profile");for(const r of t(o))if(!r.name.trim()||!r.strategic_initiatives.trim()||!r.kpi.trim()||!r.persons_involved.trim()||!r.target.trim()||!r.eval_measures.trim())throw new Error("Please fill in all fields for each objective");const a=t(o).map(r=>({...r,strategic_goal_id:t(f),profile_id:u.id})),{error:e}=await S.from("strategic_objectives").insert(a);if(e)throw e;v(g,"Strategic Objectives added successfully!"),v(o,[{name:"",strategic_initiatives:"",kpi:"",persons_involved:"",target:"",eval_measures:"",strategic_goal_id:0,profile_id:""}])}catch(a){v(m,a.message)}},h=a=>{a.style.height="auto",a.style.width="auto",a.style.height=`${a.scrollHeight}px`,a.style.width=`${Math.max(300,a.scrollWidth)}px`};gt(()=>{rt(),st()}),_t(()=>(t(g),t(m)),()=>{(t(g)||t(m))&&setTimeout(()=>{v(g,null),v(m,null)},5e3)}),ut(),ft();var I=yt(),j=n(l(I),2);Y(j,()=>t(g),a=>{var e=ht(),r=l(e),d=l(r),c=l(d,!0);i(d),i(r),i(e),E(()=>W(c,t(g))),w(a,e)});var B=n(j,2);Y(B,()=>t(m),a=>{var e=bt(),r=l(e),d=l(r),c=l(d,!0);i(d),i(r),i(e),E(()=>W(c,t(m))),w(a,e)});var M=n(B,2),O=n(l(M),2);E(()=>{t(f),p(()=>{t(P)})});var G=l(O);G.value=(G.__value=null)==null?"":null;var nt=n(G);Z(nt,1,()=>t(P),tt,(a,e)=>{var r=xt(),d={},c=l(r,!0);i(r),E(()=>{d!==(d=t(e).id)&&(r.value=(r.__value=t(e).id)==null?"":t(e).id),W(c,t(e).name)}),w(a,r)}),i(O),i(M);var D=n(M,2),J=l(D),L=n(l(J));Z(L,5,()=>t(o),tt,(a,e,r)=>{var d=wt(),c=l(d),T=l(c);b(T),i(c);var q=n(c),A=l(q);b(A),i(q);var K=n(q),R=l(K);b(R),i(K);var $=n(K),C=l($);b(C),i($);var F=n($),H=l(F);b(H),i(F);var N=n(F),U=l(N);b(U),i(N);var X=n(N),ct=l(X);i(X),i(d),x(T,()=>t(e).name,s=>(t(e).name=s,p(()=>t(o)))),_("input",T,s=>h(s.target)),x(A,()=>t(e).strategic_initiatives,s=>(t(e).strategic_initiatives=s,p(()=>t(o)))),_("input",A,s=>h(s.target)),x(R,()=>t(e).kpi,s=>(t(e).kpi=s,p(()=>t(o)))),_("input",R,s=>h(s.target)),x(C,()=>t(e).persons_involved,s=>(t(e).persons_involved=s,p(()=>t(o)))),_("input",C,s=>h(s.target)),x(H,()=>t(e).target,s=>(t(e).target=s,p(()=>t(o)))),_("input",H,s=>h(s.target)),x(U,()=>t(e).eval_measures,s=>(t(e).eval_measures=s,p(()=>t(o)))),_("input",U,s=>h(s.target)),_("click",ct,()=>lt(r)),w(a,d)}),i(L),i(J),i(D);var Q=n(D,2),V=l(Q),dt=n(V,2);i(Q),i(I),pt(O,()=>t(f),a=>v(f,a)),_("click",V,it),_("click",dt,ot),w(et,I),mt()}export{At as component};
